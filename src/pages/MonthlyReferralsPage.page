<apex:page controller="MonthlyReferralsController" cache="true" contentType="text/csv#monthlyreferralsreport.csv" showHeader="false" sidebar="false" readonly="true">Project Name,Month,Year,Probation Service Referral,Linkage Client ID,Referral Number,First Name,Surname,Date of Birth,Gender,Nationality,Date of Referral,Start Date first meeting,Outcome date,Outcome,Date of discontinued,Status,Reason for Discontinued,Name of referring Probation Officer if applicable,Completed Date,Owner of Referral,Referred From,Referred For
	<apex:repeat value="{!Clients}" var="cl">
    	Linkage,{!cl.lineMonth},{!cl.lineYear},Yes,{!cl.details.Client_Ref__c},{!cl.ReferralID},"{!cl.FirstName}","{!cl.LastName}",<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.details.Birthdate}" /></apex:outputText>,"{!cl.details.Gender__c}","{!cl.details.Client_Nationality__c}",<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.FirstReferralDate}" /></apex:outputText>,<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.StartDateFirstMeeting}" /></apex:outputText>,<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.OutcomeDate}" /></apex:outputText>,"{!cl.OutcomeStatus}",<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.DateDiscontinued}" /></apex:outputText>,"{!cl.Status}","{!cl.ReasonDiscontinued}","{!cl.ProbationOfficer}",<apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!cl.DateCompleted}" /></apex:outputText>,"{!cl.Owner}",{!cl.referredFrom},{!cl.referredFor}
    </apex:repeat>
</apex:page>